/*
RootFinder.js v0.0.1 10/30/2024
https://raw.org/book/algebra/solving-cubic-equations/

Copyright (c) 2024, Robert Eisele (https://raw.org/)
Licensed under the MIT license.
*/
'use strict';(function(k){const g={quadratic:function(a,b,c,d=!1){const e=[];if(1E-14>Math.abs(a))1E-14<Math.abs(b)&&(a=-c/b,d?e.push(a):e.push(Complex(a)));else if(c=b*b-4*a*c,1E-14>Math.abs(c))a=-b/(2*a),e.push(d?a:Complex(a));else if(0<c){const f=Math.sqrt(c);c=(-b+f)/(2*a);a=(-b-f)/(2*a);d?e.push(c,a):e.push(Complex(c),Complex(a))}else d||(d=-b/(2*a),a=Math.sqrt(-c)/(2*a),e.push(Complex(d,a),Complex(d,-a)));return e},cubic:function(a,b,c,d,e=!1){if(0===a)return g.quadratic(b,c,d,e);if(0===d)return e?
[0,...g.quadratic(a,b,c,e)]:[Complex(0),...g.quadratic(a,b,c,e)];var f=a;a=b/f;b=c/f;c=d/f;d=[];f=b-a*a/3;b=2*a*a*a/27-a*b/3+c;c=(b/2)**2+(f/3)**3;if(1E-14>Math.abs(c))1E-14>Math.abs(b)?e?d.push(-a/3):d.push(Complex(-a/3)):(c=Math.cbrt(-b/2),b=2*c-a/3,a=-c-a/3,e?d.push(b,a):d.push(Complex(b),Complex(a)));else if(0<c)f=Math.sqrt(c),c=Math.cbrt(-b/2+f),b=Math.cbrt(-b/2-f),f=c+b-a/3,e?d.push(f):(d.push(Complex(f)),e=-.5*(c+b)-a/3,a=Math.sqrt(3)/2*(c-b),d.push(Complex(e,a),Complex(e,-a)));else for(c=
Math.sqrt(-f/3),b=Math.acos(-b/(2*c**3)),f=0;3>f;f++){const h=2*c*Math.cos((b+2*Math.PI*f)/3)-a/3;e?d.push(h):d.push(Complex(h))}return d}};"function"===typeof define&&define.amd?define([],function(){return g}):"object"===typeof exports?(Object.defineProperty(g,"__esModule",{value:!0}),g["default"]=g,g.RootFinder=g,module.exports=g):k.RootFinder=g})(this);
